<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>人生已完成清单</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body class="bg-light">
<!-- 登录页面 -->
<div id="loginPage" class="container mt-5" style="max-width:400px;">
    <div class="card p-4 shadow">
        <h4 class="text-center mb-3">登录</h4>
        <div class="mb-3">
            <label class="form-label">用户名</label>
            <i class="bi bi-robot"></i>
            <input id="userCode" type="text" class="form-control" />
        </div>
        <div class="mb-3">
            <label class="form-label">密码</label>
            <input id="password" type="password" class="form-control" />
        </div>
        <button id="loginBtn" class="btn btn-primary w-100" ><i class="bi bi-robot"></i>登录</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const BASE_URL = "http://127.0.0.1:521";

    // ======= 登录 =======
    document.getElementById("loginBtn").onclick = async function () {
        const userCode = document.getElementById("userCode").value;
        const password = document.getElementById("password").value;
        fetch(`${BASE_URL}/api/login`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ userCode, password })
        })
        .then(res => res.json())
        .then(data => {
            if (data.code === 200) {
                // 存储到Session中
                sessionStorage.setItem("userInfo", JSON.stringify(data.row));
                // 跳转页面
                window.location.href = "main.html";
            } else {
                alert(data.msg || "登录失败");
            }
        });
    };
</script>
</body>
</html>
